<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Arp_packet (arp.Arp_packet)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">arp</a> &#x00BB; Arp_packet</nav><header class="odoc-preamble"><h1>Module <code><span>Arp_packet</span></code></h1><p>Conversion between wire and high-level data</p><p>The <a href="#type-t">high-level datatype</a> can be decoded and encoded to bytes to be sent on the wire. ARP specifies hardware and protocol addresses, but this implementation picks Ethernet and IPv4 statically. While decoding can result in an error, encoding can not.</p></header><nav class="odoc-toc"><ul><li><a href="#decoding">Decoding</a></li><li><a href="#encoding">Encoding</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-op"><a href="#type-op" class="anchor"></a><code><span><span class="keyword">type</span> op</span><span> = </span></code><ol><li id="type-op.Request" class="def variant constructor anchored"><a href="#type-op.Request" class="anchor"></a><code><span>| </span><span><span class="constructor">Request</span></span></code></li><li id="type-op.Reply" class="def variant constructor anchored"><a href="#type-op.Reply" class="anchor"></a><code><span>| </span><span><span class="constructor">Reply</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-op_to_int"><a href="#val-op_to_int" class="anchor"></a><code><span><span class="keyword">val</span> op_to_int : <span><a href="#type-op">op</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int_to_op"><a href="#val-int_to_op" class="anchor"></a><code><span><span class="keyword">val</span> int_to_op : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-op">op</a> option</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><ol><li id="type-t.operation" class="def record field anchored"><a href="#type-t.operation" class="anchor"></a><code><span>operation : <a href="#type-op">op</a>;</span></code></li><li id="type-t.source_mac" class="def record field anchored"><a href="#type-t.source_mac" class="anchor"></a><code><span>source_mac : <span class="xref-unresolved">Macaddr</span>.t;</span></code></li><li id="type-t.source_ip" class="def record field anchored"><a href="#type-t.source_ip" class="anchor"></a><code><span>source_ip : <span class="xref-unresolved">Ipaddr</span>.V4.t;</span></code></li><li id="type-t.target_mac" class="def record field anchored"><a href="#type-t.target_mac" class="anchor"></a><code><span>target_mac : <span class="xref-unresolved">Macaddr</span>.t;</span></code></li><li id="type-t.target_ip" class="def record field anchored"><a href="#type-t.target_ip" class="anchor"></a><code><span>target_ip : <span class="xref-unresolved">Ipaddr</span>.V4.t;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The high-level ARP frame consisting of the two address pairs and an operation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-size"><a href="#val-size" class="anchor"></a><code><span><span class="keyword">val</span> size : int</span></code></div><div class="spec-doc"><p><code>size</code> is the size of an ARP frame.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>pp ppf t</code> prints the frame <code>t</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal a b</code> returns <code>true</code> if frames <code>a</code> and <code>b</code> are equal, <code>false</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-error"><a href="#type-error" class="anchor"></a><code><span><span class="keyword">type</span> error</span><span> = </span></code><ol><li id="type-error.Too_short" class="def variant constructor anchored"><a href="#type-error.Too_short" class="anchor"></a><code><span>| </span><span><span class="constructor">Too_short</span></span></code></li><li id="type-error.Unusable" class="def variant constructor anchored"><a href="#type-error.Unusable" class="anchor"></a><code><span>| </span><span><span class="constructor">Unusable</span></span></code></li><li id="type-error.Unknown_operation" class="def variant constructor anchored"><a href="#type-error.Unknown_operation" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown_operation</span> <span class="keyword">of</span> <span class="xref-unresolved">Cstruct</span>.uint16</span></code></li></ol></div><div class="spec-doc"><p>The type of possible errors during decoding</p><ul><li><code>Too_short</code> if the provided buffer is not long enough</li><li><code>Unusable</code> if the protocol or hardware address type is not IPv4 and Ethernet</li><li><code>Unknown_operation</code> if it is neither a request nor a reply</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><code><span><span class="keyword">val</span> pp_error : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-error">error</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>pp_error ppf err</code> prints the error <code>err</code> on <code>ppf</code>.</p></div></div><h3 id="decoding"><a href="#decoding" class="anchor"></a>Decoding</h3><div class="odoc-spec"><div class="spec value anchored" id="val-decode"><a href="#val-decode" class="anchor"></a><code><span><span class="keyword">val</span> decode : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="#type-t">t</a>, <a href="#type-error">error</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>decode buf</code> attempts to decode the buffer into an ARP frame <code>t</code>.</p></div></div><h3 id="encoding"><a href="#encoding" class="anchor"></a>Encoding</h3><div class="odoc-spec"><div class="spec value anchored" id="val-encode"><a href="#val-encode" class="anchor"></a><code><span><span class="keyword">val</span> encode : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p><code>encode t</code> is a <code>buf</code>, a freshly allocated buffer, which contains the encoded ARP frame <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encode_into"><a href="#val-encode_into" class="anchor"></a><code><span><span class="keyword">val</span> encode_into : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>encode_into t buf</code> encodes <code>t</code> into the buffer <code>buf</code> at offset 0.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">Invalid_argument</span> <p>if the buffer <code>buf</code> is too small (below 28 bytes).</p></li></ul></div></div></div></body></html>